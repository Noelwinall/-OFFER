/**
 * Hong Kong 18-District GeoJSON Polygon Data
 * Simplified polygon boundaries for map visualization
 */

import type { District18 } from "@/types/school";

export interface DistrictPolygon {
  id: District18;
  coordinates: [number, number][]; // [lng, lat] pairs forming the polygon
}

/**
 * Simplified polygon coordinates for Hong Kong's 18 districts
 * Coordinates are in [longitude, latitude] format (GeoJSON standard)
 */
export const DISTRICT_POLYGONS: DistrictPolygon[] = [
  // === 港島 (Hong Kong Island) ===
  {
    id: "中西區",
    coordinates: [
      [114.1289, 22.2939],
      [114.1350, 22.2989],
      [114.1450, 22.2956],
      [114.1567, 22.2889],
      [114.1622, 22.2806],
      [114.1567, 22.2750],
      [114.1500, 22.2700],
      [114.1389, 22.2689],
      [114.1300, 22.2700],
      [114.1233, 22.2756],
      [114.1200, 22.2833],
      [114.1233, 22.2900],
      [114.1289, 22.2939],
    ],
  },
  {
    id: "灣仔區",
    coordinates: [
      [114.1567, 22.2889],
      [114.1622, 22.2900],
      [114.1722, 22.2889],
      [114.1833, 22.2833],
      [114.1889, 22.2756],
      [114.1833, 22.2689],
      [114.1722, 22.2667],
      [114.1622, 22.2700],
      [114.1567, 22.2750],
      [114.1567, 22.2889],
    ],
  },
  {
    id: "東區",
    coordinates: [
      [114.1833, 22.2833],
      [114.1889, 22.2889],
      [114.2056, 22.2944],
      [114.2222, 22.2944],
      [114.2444, 22.2889],
      [114.2556, 22.2833],
      [114.2611, 22.2722],
      [114.2556, 22.2611],
      [114.2389, 22.2556],
      [114.2167, 22.2556],
      [114.2000, 22.2611],
      [114.1889, 22.2689],
      [114.1833, 22.2756],
      [114.1833, 22.2833],
    ],
  },
  {
    id: "南區",
    coordinates: [
      [114.1200, 22.2833],
      [114.1200, 22.2700],
      [114.1233, 22.2556],
      [114.1333, 22.2389],
      [114.1444, 22.2278],
      [114.1611, 22.2167],
      [114.1833, 22.2111],
      [114.2000, 22.2167],
      [114.2111, 22.2278],
      [114.2167, 22.2389],
      [114.2167, 22.2500],
      [114.2167, 22.2556],
      [114.2000, 22.2611],
      [114.1833, 22.2667],
      [114.1722, 22.2667],
      [114.1622, 22.2700],
      [114.1500, 22.2700],
      [114.1389, 22.2689],
      [114.1300, 22.2700],
      [114.1233, 22.2756],
      [114.1200, 22.2833],
    ],
  },

  // === 九龍 (Kowloon) ===
  {
    id: "油尖旺區",
    coordinates: [
      [114.1556, 22.2989],
      [114.1611, 22.3056],
      [114.1667, 22.3167],
      [114.1722, 22.3222],
      [114.1833, 22.3167],
      [114.1833, 22.3056],
      [114.1778, 22.2989],
      [114.1667, 22.2944],
      [114.1556, 22.2989],
    ],
  },
  {
    id: "深水埗區",
    coordinates: [
      [114.1389, 22.3167],
      [114.1444, 22.3278],
      [114.1500, 22.3389],
      [114.1611, 22.3444],
      [114.1722, 22.3389],
      [114.1778, 22.3278],
      [114.1722, 22.3167],
      [114.1667, 22.3056],
      [114.1611, 22.3056],
      [114.1500, 22.3111],
      [114.1389, 22.3167],
    ],
  },
  {
    id: "九龍城區",
    coordinates: [
      [114.1778, 22.3056],
      [114.1833, 22.3167],
      [114.1889, 22.3278],
      [114.1944, 22.3389],
      [114.2056, 22.3389],
      [114.2111, 22.3278],
      [114.2056, 22.3167],
      [114.1944, 22.3056],
      [114.1833, 22.2989],
      [114.1778, 22.2989],
      [114.1778, 22.3056],
    ],
  },
  {
    id: "黃大仙區",
    coordinates: [
      [114.1778, 22.3278],
      [114.1833, 22.3389],
      [114.1889, 22.3500],
      [114.1944, 22.3556],
      [114.2056, 22.3556],
      [114.2167, 22.3500],
      [114.2167, 22.3389],
      [114.2111, 22.3278],
      [114.2056, 22.3389],
      [114.1944, 22.3389],
      [114.1889, 22.3278],
      [114.1778, 22.3278],
    ],
  },
  {
    id: "觀塘區",
    coordinates: [
      [114.2056, 22.3167],
      [114.2111, 22.3278],
      [114.2167, 22.3389],
      [114.2222, 22.3278],
      [114.2333, 22.3222],
      [114.2444, 22.3167],
      [114.2500, 22.3056],
      [114.2444, 22.2944],
      [114.2333, 22.2889],
      [114.2167, 22.2944],
      [114.2056, 22.3056],
      [114.2056, 22.3167],
    ],
  },

  // === 新界 (New Territories) ===
  {
    id: "荃灣區",
    coordinates: [
      [114.0889, 22.3556],
      [114.0944, 22.3667],
      [114.1056, 22.3778],
      [114.1222, 22.3833],
      [114.1333, 22.3778],
      [114.1389, 22.3667],
      [114.1333, 22.3556],
      [114.1222, 22.3500],
      [114.1056, 22.3500],
      [114.0889, 22.3556],
    ],
  },
  {
    id: "葵青區",
    coordinates: [
      [114.1056, 22.3389],
      [114.1111, 22.3500],
      [114.1222, 22.3556],
      [114.1333, 22.3611],
      [114.1444, 22.3556],
      [114.1500, 22.3444],
      [114.1444, 22.3333],
      [114.1333, 22.3278],
      [114.1222, 22.3278],
      [114.1111, 22.3333],
      [114.1056, 22.3389],
    ],
  },
  {
    id: "屯門區",
    coordinates: [
      [113.9444, 22.3667],
      [113.9500, 22.3833],
      [113.9611, 22.4000],
      [113.9778, 22.4111],
      [113.9944, 22.4056],
      [114.0056, 22.3889],
      [114.0000, 22.3722],
      [113.9833, 22.3611],
      [113.9611, 22.3556],
      [113.9444, 22.3667],
    ],
  },
  {
    id: "元朗區",
    coordinates: [
      [113.9833, 22.4167],
      [113.9944, 22.4333],
      [114.0111, 22.4500],
      [114.0333, 22.4611],
      [114.0556, 22.4611],
      [114.0722, 22.4500],
      [114.0722, 22.4333],
      [114.0556, 22.4222],
      [114.0333, 22.4167],
      [114.0111, 22.4111],
      [113.9833, 22.4167],
    ],
  },
  {
    id: "北區",
    coordinates: [
      [114.1056, 22.4667],
      [114.1167, 22.4833],
      [114.1333, 22.5000],
      [114.1556, 22.5111],
      [114.1778, 22.5056],
      [114.1889, 22.4889],
      [114.1778, 22.4722],
      [114.1556, 22.4611],
      [114.1333, 22.4556],
      [114.1167, 22.4611],
      [114.1056, 22.4667],
    ],
  },
  {
    id: "大埔區",
    coordinates: [
      [114.1389, 22.4278],
      [114.1500, 22.4444],
      [114.1667, 22.4556],
      [114.1833, 22.4611],
      [114.2000, 22.4556],
      [114.2056, 22.4389],
      [114.1944, 22.4222],
      [114.1778, 22.4167],
      [114.1611, 22.4167],
      [114.1444, 22.4222],
      [114.1389, 22.4278],
    ],
  },
  {
    id: "沙田區",
    coordinates: [
      [114.1667, 22.3611],
      [114.1722, 22.3778],
      [114.1833, 22.3944],
      [114.2000, 22.4000],
      [114.2167, 22.3944],
      [114.2222, 22.3778],
      [114.2111, 22.3611],
      [114.1944, 22.3556],
      [114.1778, 22.3556],
      [114.1667, 22.3611],
    ],
  },
  {
    id: "西貢區",
    coordinates: [
      [114.2222, 22.3611],
      [114.2333, 22.3778],
      [114.2500, 22.3944],
      [114.2722, 22.4000],
      [114.2944, 22.3889],
      [114.3056, 22.3722],
      [114.2944, 22.3556],
      [114.2722, 22.3444],
      [114.2500, 22.3389],
      [114.2333, 22.3444],
      [114.2222, 22.3611],
    ],
  },
  {
    id: "離島區",
    coordinates: [
      [113.9167, 22.2444],
      [113.9278, 22.2611],
      [113.9444, 22.2778],
      [113.9667, 22.2833],
      [113.9889, 22.2778],
      [114.0000, 22.2611],
      [113.9889, 22.2444],
      [113.9667, 22.2333],
      [113.9444, 22.2278],
      [113.9278, 22.2333],
      [113.9167, 22.2444],
    ],
  },
];

/**
 * Get polygon data for a specific district
 */
export function getDistrictPolygon(districtId: District18): DistrictPolygon | undefined {
  return DISTRICT_POLYGONS.find((d) => d.id === districtId);
}

/**
 * Convert to GeoJSON Feature format
 */
export function toGeoJSONFeature(polygon: DistrictPolygon, properties?: Record<string, any>) {
  return {
    type: "Feature" as const,
    properties: {
      districtId: polygon.id,
      ...properties,
    },
    geometry: {
      type: "Polygon" as const,
      coordinates: [polygon.coordinates],
    },
  };
}

/**
 * Convert all districts to GeoJSON FeatureCollection
 */
export function toGeoJSONCollection(propertiesMap?: Map<District18, Record<string, any>>) {
  return {
    type: "FeatureCollection" as const,
    features: DISTRICT_POLYGONS.map((polygon) =>
      toGeoJSONFeature(polygon, propertiesMap?.get(polygon.id))
    ),
  };
}
